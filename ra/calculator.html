<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Responsive web-based calculator built with HTML, CSS, and JavaScript">
    <meta name="keywords" content="calculator, web development, HTML, CSS, JavaScript">
    <meta name="author" content="B Raveendra Babu">
    <title>Web-Based Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f2f2f2;
            margin: 0;
        }
        .calculator {
            width: 320px;
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        .display {
            width: 100%;
            height: 50px;
            text-align: right;
            font-size: 1.5rem;
            padding: 10px;
            margin-bottom: 20px;
            border: none;
            background-color: #ffeb3b;
            border-radius: 8px;
            color: #333;
            box-sizing: border-box;
        }
        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        .button {
            background-color: #03a9f4;
            border: none;
            font-size: 1.5rem;
            padding: 20px;
            cursor: pointer;
            border-radius: 10px;
            transition: background-color 0.3s, transform 0.2s;
            color: white;
        }
        .button:hover {
            background-color: #0288d1;
            transform: scale(1.1);
        }
        .button:active {
            transform: scale(0.95);
        }
        .button.clear {
            background-color: #ff5722;
        }
        .button.clear:hover {
            background-color: #e64a19;
        }
        .button.equal {
            background-color: #8bc34a;
        }
        .button.equal:hover {
            background-color: #689f38;
        }
        .button.operator {
            background-color: #ff9800;
        }
        .button.operator:hover {
            background-color: #f57c00;
        }
        .button.history {
            background-color: #9c27b0;
        }
        .button.history:hover {
            background-color: #7b1fa2;
        }
        #historyModal {
            display: none;
            position: fixed;
            top: 20%;
            left: 10%;
            right: 10%;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            max-height: 60vh;
            overflow-y: auto;
        }
        #historyModal h3 {
            margin-top: 0;
            color: #004aad;
        }
        #historyModal ul {
            list-style: none;
            padding: 0;
        }
        #historyModal li {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        #historyModal button {
            margin: 10px 5px;
            padding: 8px 16px;
            background: #004aad;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        #historyModal button:hover {
            background: #003087;
        }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
        @media (max-width: 400px) {
            .calculator {
                width: 250px;
                padding: 15px;
            }
            .button {
                font-size: 1.2rem;
                padding: 15px;
            }
            .display {
                font-size: 1.2rem;
                height: 40px;
            }
            #historyModal {
                left: 5%;
                right: 5%;
            }
        }
    </style>
</head>
<body>
    <div class="calculator">
        <input type="text" id="display" class="display" disabled aria-label="Calculator Display">
        <div class="buttons">
            <button class="button clear" onclick="clearDisplay()" aria-label="Clear Display">C</button>
            <button class="button history" onclick="showHistory()" aria-label="Show Calculation History">Hist</button>
            <button class="button operator" onclick="appendOperation('√')" aria-label="Square Root">√</button>
            <button class="button operator" onclick="appendOperation('%')" aria-label="Percentage">%</button>

            <button class="button" onclick="appendNumber('7')" aria-label="Number 7">7</button>
            <button class="button" onclick="appendNumber('8')" aria-label="Number 8">8</button>
            <button class="button" onclick="appendNumber('9')" aria-label="Number 9">9</button>
            <button class="button operator" onclick="appendOperation('/')" aria-label="Divide">/</button>

            <button class="button" onclick="appendNumber('4')" aria-label="Number 4">4</button>
            <button class="button" onclick="appendNumber('5')" aria-label="Number 5">5</button>
            <button class="button" onclick="appendNumber('6')" aria-label="Number 6">6</button>
            <button class="button operator" onclick="appendOperation('*')" aria-label="Multiply">*</button>

            <button class="button" onclick="appendNumber('1')" aria-label="Number 1">1</button>
            <button class="button" onclick="appendNumber('2')" aria-label="Number 2">2</button>
            <button class="button" onclick="appendNumber('3')" aria-label="Number 3">3</button>
            <button class="button operator" onclick="appendOperation('-')" aria-label="Subtract">-</button>

            <button class="button" onclick="appendNumber('0')" aria-label="Number 0">0</button>
            <button class="button" onclick="appendNumber('.')" aria-label="Decimal Point">.</button>
            <button class="button" onclick="backspace()" aria-label="Backspace">←</button>
            <button class="button operator" onclick="appendOperation('+')" aria-label="Add">+</button>

            <button class="button equal" onclick="calculate()" aria-label="Calculate" style="grid-column: span 4;">=</button>
        </div>
    </div>
    <div class="modal-overlay" id="modalOverlay"></div>
    <div id="historyModal">
        <h3>Calculation History</h3>
        <ul id="historyList"></ul>
        <button onclick="clearHistory()">Clear History</button>
        <button onclick="closeHistory()">Close</button>
    </div>

    <script>
        let currentInput = '';
        let currentOperation = '';
        let previousInput = '';

        function updateDisplay() {
            document.getElementById('display').value = `${previousInput} ${currentOperation} ${currentInput}`.trim();
        }

        function appendNumber(number) {
            if (number === '.' && currentInput.includes('.')) return;
            currentInput += number;
            updateDisplay();
        }

        function appendOperation(operation) {
            if (operation === '√') {
                if (currentInput === '' || isNaN(currentInput) || parseFloat(currentInput) < 0) {
                    alert('Please enter a non-negative number for square root');
                    return;
                }
                const result = Math.sqrt(parseFloat(currentInput));
                saveCalculation(`√${currentInput}`, result.toFixed(8));
                currentInput = result.toString();
                currentOperation = '';
                previousInput = '';
                updateDisplay();
                return;
            }
            if (operation === '%') {
                if (currentInput === '' || isNaN(currentInput)) return;
                const result = parseFloat(currentInput) / 100;
                saveCalculation(`${currentInput}%`, result.toFixed(8));
                currentInput = result.toString();
                if (previousInput) {
                    calculate();
                } else {
                    updateDisplay();
                }
                return;
            }
            if (currentInput === '' || isNaN(currentInput)) return;
            if (previousInput !== '') {
                calculate();
            }
            currentOperation = operation;
            previousInput = currentInput;
            currentInput = '';
            updateDisplay();
        }

        function calculate() {
            if (previousInput === '' || currentInput === '' || isNaN(previousInput) || isNaN(currentInput)) return;
            let result;
            const prev = parseFloat(previousInput);
            const current = parseFloat(currentInput);

            switch (currentOperation) {
                case '+':
                    result = prev + current;
                    break;
                case '-':
                    result = prev - current;
                    break;
                case '*':
                    result = prev * current;
                    break;
                case '/':
                    if (current === 0) {
                        alert("Cannot divide by zero");
                        return;
                    }
                    result = prev / current;
                    break;
                default:
                    return;
            }

            saveCalculation(`${previousInput} ${currentOperation} ${currentInput}`, result.toFixed(8));
            currentInput = result.toString();
            currentOperation = '';
            previousInput = '';
            updateDisplay();
        }

        function backspace() {
            currentInput = currentInput.slice(0, -1);
            updateDisplay();
        }

        function clearDisplay() {
            currentInput = '';
            previousInput = '';
            currentOperation = '';
            updateDisplay();
        }

        function saveCalculation(expression, result) {
            const calculations = JSON.parse(localStorage.getItem('calculations') || '[]');
            calculations.push({ expression, result });
            localStorage.setItem('calculations', JSON.stringify(calculations));
        }

        function showHistory() {
            const calculations = JSON.parse(localStorage.getItem('calculations') || '[]');
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = calculations.length
                ? calculations.map(calc => `<li>${calc.expression} = ${calc.result}</li>`).join('')
                : '<li>No calculations yet</li>';
            document.getElementById('historyModal').style.display = 'block';
            document.getElementById('modalOverlay').style.display = 'block';
        }

        function clearHistory() {
            localStorage.removeItem('calculations');
            document.getElementById('historyList').innerHTML = '<li>No calculations yet</li>';
        }

        function closeHistory() {
            document.getElementById('historyModal').style.display = 'none';
            document.getElementById('modalOverlay').style.display = 'none';
        }

        // Keyboard Support
        document.addEventListener('keydown', function (e) {
            if (e.key >= '0' && e.key <= '9' || e.key === '.') appendNumber(e.key);
            if (['+', '-', '*', '/'].includes(e.key)) appendOperation(e.key);
            if (e.key === 'Enter') calculate();
            if (e.key === 'Backspace') backspace();
            if (e.key === 'Escape') clearDisplay();
        });

        // Initialize display
        updateDisplay();
    </script>
</body>
</html>